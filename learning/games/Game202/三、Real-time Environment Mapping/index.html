<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="google-site-verification" content="XqWEZ-KjvQT4IfXzxYvH-PEc--_zN6GqthY2jBsqOs4"><meta name="msvalidate.01" content="4E28E3FDD5912EBBB84869B17359650D"><meta name="baidu-site-verification" content="code-dwpSTDBLS2"><link rel="alternate" type="application/rss+xml" title="鑫酱" href="https://hakuya.me/rss.xml"><link rel="alternate" type="application/atom+xml" title="鑫酱" href="https://hakuya.me/atom.xml"><link rel="alternate" type="application/json" title="鑫酱" href="https://hakuya.me/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="图形学,线性代数,OpenGL"><link rel="canonical" href="https://hakuya.me/learning/games/Game202/%E4%B8%89%E3%80%81Real-time%20Environment%20Mapping/"><title>三、Real-time Environment Mapping - GAME202高质量实时渲染 - Games系列 - 学习 | 个人博客 = 鑫酱 = 笔记本</title><meta name="generator" content="Hexo 6.2.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">三、Real-time Environment Mapping</h1><div class="meta"><span class="item" title="创建时间：2021-06-10 16:22:00"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2021-06-10T16:22:00+08:00">2021-06-10</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>6.7k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>6 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">个人博客</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://wallpaper-1255596461.cos.ap-nanjing.myqcloud.com/wallpaper (10).jpg"></li><li class="item" data-background-image="https://wallpaper-1255596461.cos.ap-nanjing.myqcloud.com/wallpaper_2.jpg"></li><li class="item" data-background-image="https://wallpaper-1255596461.cos.ap-nanjing.myqcloud.com/wallpaper (7).jpg"></li><li class="item" data-background-image="https://wallpaper-1255596461.cos.ap-nanjing.myqcloud.com/wallpaper (6).jpg"></li><li class="item" data-background-image="https://wallpaper-1255596461.cos.ap-nanjing.myqcloud.com/wallpaper (23).jpg"></li><li class="item" data-background-image="https://wallpaper-1255596461.cos.ap-nanjing.myqcloud.com/wallpaper (3).jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/learning/" itemprop="item" rel="index" title="分类于 学习"><span itemprop="name">学习</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/learning/games/" itemprop="item" rel="index" title="分类于 Games系列"><span itemprop="name">Games系列</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/learning/games/Game202/" itemprop="item" rel="index" title="分类于 GAME202高质量实时渲染"><span itemprop="name">GAME202高质量实时渲染</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://hakuya.me/learning/games/Game202/%E4%B8%89%E3%80%81Real-time%20Environment%20Mapping/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="鑫酱(●'◡'●)"><meta itemprop="description" content="笔记本, 整天摸鱼，却妄想拯救世界的技术宅"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="鑫酱"></span><div class="body md" itemprop="articleBody"><div class="note info"><p>以下为个人学习笔记整理，<span class="exturl" data-url="aHR0cHM6Ly9zaXRlcy5jcy51Y3NiLmVkdS9+bGluZ3FpL3RlYWNoaW5nL2dhbWVzMjAyLmh0bWw=">课程官网传送门</span>，<span class="exturl" data-url="aHR0cDovL2dhbWVzLWNuLm9yZy9mb3J1bXMvdG9waWMvZ2FtZXMyMDJ6dW95ZWh1aXpvbmcv">作业传送门</span>，<span class="exturl" data-url="aHR0cDovL3d3dy5zbWFydGNoYWlyLm9yZy9HQU1FUzIwMg==">会议系统传送门</span>。</p></div><h1 id="real-time-environment-mapping"><a class="anchor" href="#real-time-environment-mapping">#</a> Real-time Environment Mapping</h1><p>环境光照认为所有的光线都是来自「无限远」的（所有光线强度是相同的）。</p><h2 id="shading-from-environment-lighting"><a class="anchor" href="#shading-from-environment-lighting">#</a> Shading from Environment Lighting</h2><p>环境光也被称为「Image-Based Lighting」（IBL）。</p><h3 id="how-to-use-it-to-shade-a-pointwithout-shadows"><a class="anchor" href="#how-to-use-it-to-shade-a-pointwithout-shadows">#</a> How to use it to shade a point（without shadows）？</h3><ul><li>Solving the rendering equation：由于环境光不考虑阴影（遮挡）因此不需要计算「Visibility 函数」</li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605173430.png" alt="image-20210605173429913"></p><ul><li>General solution - Monte Carlo Integration <a href="https://hakuya.me/learning/games/Game101/%E5%8D%81%E4%B8%83%E3%80%81Ray%20Tracing%E2%80%94%E2%80%94Monte%20Carlo%20Path%20Tracing/">GAME101 蒙特卡洛积分</a><ul><li>Numerical</li><li>Large amount of samples required</li></ul></li></ul><h3 id="observation"><a class="anchor" href="#observation">#</a> Observation</h3><p>渲染方程本质上就是对一个物体的半球进行「BRDF」X 「光照强度」的积分。</p><h4 id="brdf的特性"><a class="anchor" href="#brdf的特性">#</a> BRDF 的特性：</h4><ul><li>如果「BRDF」是非常光滑的，那么它的反射光线就更加的聚集（接近镜面反射），因此积分的有效区域就更小。—— small support！</li><li>如果「BRDF」是非常粗糙的，那么它的反射光线就更加分散（接近漫反射），但是反射到各个方向的光照强度却非常接近。—— smooth！</li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605175128.png" alt="image-20210605175125692"></p><ul><li>因此这里也可以对积分套用 <a href="https://hakuya.me/learning/games/Game202/%E4%BA%8C%E3%80%81Real-time%20Shadows/">GAME202 Shadow PCF</a> 部分相同的近似函数进行近似，并且非常满足近似条件：<ul><li><code>g(x)</code> 足够 smooth 。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="normal">Ω</mi><mi>G</mi></msub></mrow><annotation encoding="application/x-tex">\Omega_G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord">Ω</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.32833099999999993em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">G</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 足够的 small support 。</li></ul></li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605175321.png" alt="image-20210605175320546"></p><ul><li>因此我们可以对渲染方差做一个近似处理：</li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605180036.png" alt="image-20210605180034588"></p><h2 id="the-split-sum"><a class="anchor" href="#the-split-sum">#</a> The Split Sum</h2><h3 id="step1prefiltering-of-the-environment-lighting"><a class="anchor" href="#step1prefiltering-of-the-environment-lighting">#</a> 【step1】Prefiltering of the environment lighting</h3><p>试想一下，需要对光照进行积分并且除以积分域。</p><ul><li>如果积分域很小（BRFR 很光滑），那么「shading point」光照强度本身的值就可以作为积分后的结果。所以每个「shading point」的着色都接近本身的光线。</li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605181928.png" alt="image-20210605181926865"></p><ul><li><p>如果积分域很大（BRDF 很粗糙），并且光线函数非常的 smooth。「shading point」的光照强度就等于附近点的平均。那么对光照进行积分并且除以积分域后的结果体现在图片上其实就是对周围一定区域内所有像素点的颜色进行「filtering」。</p></li><li><p>因此就能够类似 MIPMAP 的方式预处理多种「BRDF」情况下的环境光效果，然后针对不同「BRDF」的物体，对两张环境光贴图进行插值获得环境光。类似 <a href="https://hakuya.me/learning/games/Game101/%E4%B9%9D%E3%80%81Shading%EF%BC%88%E4%B8%8B%EF%BC%89%E2%80%94%E2%80%94Texture%20Mapping%20Cont/">GAME101 Texture Mapping 三线性插值</a></p></li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605180813.png" alt="image-20210605180811350"></p><h3 id="step2prefiltering-of-the-environment-lighting"><a class="anchor" href="#step2prefiltering-of-the-environment-lighting">#</a> 【step2】Prefiltering of the environment lighting</h3><p>解决对范围「BRDF」求积分</p><h4 id="microfacet-brdf"><a class="anchor" href="#microfacet-brdf">#</a> Microfacet BRDF</h4><p><a href="https://hakuya.me/learning/games/Game101/%E5%8D%81%E5%85%AB%E3%80%81Materials%20and%20Appearances/">GAME101 Microfacet BRDF 回顾</a></p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605183452.png" alt="image-20210605183449622"></p><blockquote><p>Fersnel Term</p></blockquote><p>在菲涅尔项中，定义了入射角 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mi>o</mi><mi>s</mi><mi>θ</mi></mrow><annotation encoding="application/x-tex">cos \theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal">c</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord mathnormal" style="margin-right:.02778em">θ</span></span></span></span> 和反射率（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">R_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>）对反射结果的影响</p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">R_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>：定义为通过介质的光线中被反射的光线占比。</li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605185140.png" alt="image-20210605185139051"></p><blockquote><p>NDF Term</p></blockquote><p>「NDF Term」定义了材质（微表面）的法线分布情况，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.0037em">α</span></span></span></span> 表示材质是光滑还是粗糙的，影响曲线宽度；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.69444em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.02778em">θ</span></span></span></span> 角度可以用入射角近似。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605184402.png" alt="image-20210605184401323"></p><h4 id="split-again"><a class="anchor" href="#split-again">#</a> Split again</h4><p>由于「BRDF」还是太复杂，因此，决定对「BRDF」再次进行拆解。</p><ul><li>把菲涅尔项里的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">R_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 先拆出来</li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605185318.png" alt="image-20210605185316496"></p><ul><li>得到的两个积分项则可以不依赖反射率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>R</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">R_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.00773em">R</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.30110799999999993em"><span style="top:-2.5500000000000003em;margin-left:-.00773em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>，因此可以对剩下的变量（粗糙度、入射角）进行预处理。<ul><li>最终可以得到一张预处理后记录「粗糙度」和「入射角」的 2D 贴图。</li></ul></li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605185728.png" alt="image-20210605185726994"></p><h2 id="the-split-sum-approximation"><a class="anchor" href="#the-split-sum-approximation">#</a> The Split Sum Approximation</h2><ul><li>最终的结果规避了采样的性能消耗，全部由预处理来完成。</li><li>速度得到了提升，并且非常近似之前的正常计算结果。</li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210605190341.png" alt="image-20210605190340068"></p><h2 id="shadow-from-environment-lighting"><a class="anchor" href="#shadow-from-environment-lighting">#</a> Shadow from Environment Lighting</h2><p>环境光阴影的实现相对较为困难：</p><ul><li>环境光本身类似一个多光源问题，多个方向上的光线可以视作多个光源～，这种情况下生成的「shadow map」数量巨大，并不可行。</li><li>如果把环境光阴影的渲染视作一个抽样问题，想要用近似处理将不再准确，因为不满足其两个条件（要么 「small support」 要么 「smooth」）：<ul><li>环境光的渲染方程中「Visibility 函数」的计算比较复杂，每个点都得考虑周围半球的遮挡情况。</li><li>BRDF 如果粗糙还比较好处理，但是光滑的 BRDF 就没有那么「smooth」了。</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 本身也并非「small support」的，环境光的光线来自于半球内任何方向。</li></ul></li></ul><h3 id="industrial-solution"><a class="anchor" href="#industrial-solution">#</a> Industrial solution</h3><p>工业上一般的解决方案：用最亮的一个或者多个光源来产生阴影。忽略掉其他的小光源。</p><h3 id="related-research"><a class="anchor" href="#related-research">#</a> Related research</h3><ul><li>Imperfect shadow maps</li><li>Light cuts</li><li>RTRT（might be the ultimate solution）</li><li>Precomputed radiance transfer</li></ul><h2 id="fourier-transform"><a class="anchor" href="#fourier-transform">#</a> Fourier Transform</h2><p><a href="https://hakuya.me/learning/games/Game101/%E4%BA%94%E3%80%81Rasterization%EF%BC%88%E4%B8%AD%EF%BC%89%E2%80%94%E2%80%94Antialiasing/">GAME101 傅里叶变换介绍</a>。「任何函数」都可以通过一系列的 <code>sin</code> 、 <code>cos</code> 函数来表示。</p><h3 id="general-understanding"><a class="anchor" href="#general-understanding">#</a> general understanding</h3><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210608155003.png" alt="image-20210608154955382"></p><ul><li>「filtering」操作可以理解为做了一个「卷积」</li><li>「Low frequency」 == 「smooth function」 / 「slow changes」</li><li>多个函数乘积积分结果取决于较低频率的函数</li></ul><h2 id="basis-functions"><a class="anchor" href="#basis-functions">#</a> Basis Functions</h2><p>「基函数」的定义是：可以通过「基函数」的不同组合，来表示任意的函数</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210608165221.png" alt="image-20210608165220015"></p><ul><li>傅里叶级数也是一组「基函数」</li><li>多项式级数也是一组「基函数」</li></ul><h2 id="real-time-environment-lighting-global-illumination"><a class="anchor" href="#real-time-environment-lighting-global-illumination">#</a> Real-time environment lighting（&amp; global illumination）</h2><h3 id="spherical-harmonics"><a class="anchor" href="#spherical-harmonics">#</a> Spherical Harmonics</h3><p>「球面谐波函数」是一系列的二维的定义在球面上的「基函数」</p><p>有点类似一维的傅里叶级数：</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210608170954.png" alt="image-20210608170953042"></p><ul><li>每个「球面谐波函数」<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>ω</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">B_i(\omega)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:.03588em">ω</span><span class="mclose">)</span></span></span></span> 都与一个「Legendre」多项式有关</li><li>投影：「球面谐波函数」另一个性质是计算该「基函数」的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 比较简单：<ul><li>「基函数」可看作是「坐标轴」。假设一个 N 维向量需要用 N 维坐标表示，那么每个维度的表示结果就是「基函数」，而该 N 维向量在任意「基函数」的「投影」，就是求该「基函数」的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 。而该 N 维向量，则可以通过多个「基函数」和「投影」乘积的和表示。</li></ul></li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210608173128.png" alt="image-20210608173127610"></p><h4 id="sh-properites"><a class="anchor" href="#sh-properites">#</a> SH properites</h4><ul><li>orthonormal：正交性。一个基函数投影到任意的基函数上结果为 0，基函数两两垂直。</li><li>simple projection /reconstruction：投影计算较为简单。只需要用该函数和基函数做一个「product integral」</li><li>simple rotation：非常支持旋转。原函数旋转后的结果相当于对每个基函数做旋转并求和的结果，另外可以用同届的多个基函数组合来表示旋转任意角度的某个同届基函数。</li><li>simple convolution：卷积非常简单。两个频域上各点的乘积等于图像和卷积核的卷积。<a href="https://hakuya.me/learning/games/Game101/%E4%BA%94%E3%80%81Rasterization%EF%BC%88%E4%B8%AD%EF%BC%89%E2%80%94%E2%80%94Antialiasing/">GAME101 卷积</a></li><li>few basis function：low frequencys，一般渲染中只用到了 3 阶。</li></ul><h3 id="perfiltering"><a class="anchor" href="#perfiltering">#</a> Perfiltering</h3><p>「Perfiltering」+「single query」 = 「no filtering」+「multiple queries」，说明见 [The Split Sum](#The Split Sum)</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210608175514.png" alt="image-20210608175513332"></p><h3 id="analytic-irradiance-formula"><a class="anchor" href="#analytic-irradiance-formula">#</a> Analytic Irradiance Formula</h3><ul><li>Diffuse BRDF acts lite a low-pass filter：漫反射的「BRDF」可以看成是一个低通滤波器。</li></ul><p>一个比较好的性质就是如果用「球面谐波函数」来描述一个「Diffuse BRDF」，大概只需要三阶「基函数」即可 ——（0、1、2）就可以拟合的很好，后面几阶的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">c_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.58056em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 值已经近似为 0，对最终结果影响不大。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609110931.png" alt="image-20210609110924098"></p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>E</mi><mrow><mi>l</mi><mi>m</mi></mrow></msub><mo>=</mo><msub><mi>A</mi><mi>l</mi></msub><msub><mi>L</mi><mrow><mi>l</mi><mi>m</mi></mrow></msub></mrow><annotation encoding="application/x-tex">E_{lm} = A_l L_{lm}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:-.05764em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.33610799999999996em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:.01968em">l</span><span class="mord mathnormal mtight">m</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span></span></p><p>换句话说，由于「Diffuse BRDF」本身就只有三阶（低频），而两个函数乘积积分的结果取决于较低频的函数。因此</p><p>「Diffuse BRDF」X「<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>」的积分结果更取决于「Diffuse BRDF」，而「Diffuse BRDF」只有前三阶有校，因此「<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>」</p><p>也只需要考虑前三阶即可。</p><h4 id="9-parameter-approximation"><a class="anchor" href="#9-parameter-approximation">#</a> 9 Parameter Approximation</h4><p>分别用 「<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>」的前三阶带入计算对于差异：</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609170016.png" alt="image-20210609170015498"></p><blockquote><p>【Order 0】一个基函数</p></blockquote><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609165831.png" alt="image-20210609165828912"></p><blockquote><p>【Order 1】4 个基函数</p></blockquote><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609165910.png" alt="image-20210609165909396"></p><blockquote><p>【Order 2】9 个基函数</p></blockquote><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609165959.png" alt="image-20210609165958930"></p><h3 id="in-real-time-renderingfyi"><a class="anchor" href="#in-real-time-renderingfyi">#</a> In Real-Time Rendering（FYI）</h3><p>只考虑「基函数」前三阶的情况下，方程最终可以简化为向量和矩阵的乘积在对向量点积。</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>E</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mi>n</mi><mi>t</mi></msup><mo>×</mo><mi>M</mi><mo>⋅</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">E(n) = n^t \times M \cdot n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.05764em">E</span><span class="mopen">(</span><span class="mord mathnormal">n</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.926886em;vertical-align:-.08333em"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:.843556em"><span style="top:-3.113em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.68333em;vertical-align:0"></span><span class="mord mathnormal" style="margin-right:.10903em">M</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.43056em;vertical-align:0"></span><span class="mord mathnormal">n</span></span></span></span></span></p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609170653.png" alt="image-20210609170652189"></p><blockquote><p>以上内容都是在讨论「shading」而非 「shadow」</p></blockquote><h2 id="precomputed-radiance-transferprt"><a class="anchor" href="#precomputed-radiance-transferprt">#</a> Precomputed Radiance Transfer（PRT）</h2><h3 id="rendering-under-environment-lighting"><a class="anchor" href="#rendering-under-environment-lighting">#</a> Rendering under environment lighting</h3><p>以下图的红点处为例进行环境光渲染：</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609171811.png" alt="image-20210609171809961"></p><p>可以通过该点预先得到以下预处理结果：</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609171706.png" alt="image-20210609171705502"></p><ul><li>lighting：可以对所有半球内的入射光线积分得到（球面谐波函数）</li><li>visibility：对半球内的遮挡情况进行判断，可以用「shading point」对求面内所有方向都做一次 tracing 判断（球面谐波函数）</li><li>BRDF：本身是个四维函数（入射方向 2 维 X 出射方向 2 维）。假如给定一个出射方向，该函数也会是一个和入射方向相关的函数 —— 和半球积分相关（球面谐波函数）</li></ul><p>如果要计算一个点的光照，只需要把三个函数的结果乘起来在做积分。对应于三张图片相同位置的乘积和。</p><p>但是这样就意味着每个「shading point」都需要生成这样三张预处理的图片。</p><h3 id="basic-idea-of-prt"><a class="anchor" href="#basic-idea-of-prt">#</a> Basic idea of PRT</h3><p>核心思想：由于「Visibility 函数」和「BRDF」在任何时间情况下都是不变的，能发生变化的只有「Lighting」。于是乎可以先提前计算出每个点的「Visibility 函数」和「BRDF」的乘积，这样就能少存一份贴图和运行时少算一次乘积。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609173451.png" alt="image-20210609173450618"></p><h3 id="diffuse-brdf-case"><a class="anchor" href="#diffuse-brdf-case">#</a> Diffuse BRDF Case</h3><p>diffuse 情况下「BRDF」（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ρ</mi></mrow><annotation encoding="application/x-tex">\rho</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal">ρ</span></span></span></span>）本身就是一个常数，因此可以把公式写成如下形式。</p><ul><li>再把 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">L(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> 当作是一个「球面谐波函数」带入公式</li><li>并且把 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo></mrow><annotation encoding="application/x-tex">\sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-.25001em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">l_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.84444em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.01968em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 提到积分外，近似处理</li><li>剩下的内容，其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∫</mo><mi mathvariant="normal">Ω</mi></msub><msub><mi>B</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mi>V</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>n</mi><mo>⋅</mo><mi>i</mi><mo stretchy="false">)</mo><mi>d</mi><mi>i</mi></mrow><annotation encoding="application/x-tex">\int_{\Omega}B_i(i)V(i)max(0,n \cdot i)di</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1608200000000002em;vertical-align:-.35582em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.12251099999999993em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Ω</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:.16666666666666666em"></span><span class="mord mathnormal">n</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">i</span><span class="mclose">)</span><span class="mord mathnormal">d</span><span class="mord mathnormal">i</span></span></span></span> 又表示 [「light transport」「球面谐波函数」投影到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 上的系数](#Spherical Harmonics)</li></ul><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609174945.png" alt="image-20210609174944368"></p><p>由于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>V</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">V(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.22222em">V</span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span> 参与预计算，所以是不能够在渲染过程中改变的，换句话说，场景内的物体是不可以移动的。</p><p>另外，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 由于展开成「基函数」的描述，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">B_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span> 项也已经在预计算中处理了，因此光源只能够新增或者减少（对应于公式中新增和减少 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>∫</mo><mi mathvariant="normal">Ω</mi></msub></mrow><annotation encoding="application/x-tex">\int_{\Omega}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1608200000000002em;vertical-align:-.35582em"></span><span class="mop"><span class="mop op-symbol small-op" style="margin-right:.19445em;position:relative;top:-.0005599999999999772em">∫</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.12251099999999993em"><span style="top:-2.34418em;margin-left:-.19445em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">Ω</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.35582em"><span></span></span></span></span></span></span></span></span></span> 求和项），但是不能改变其中某一项的结果，比如调整光源方向。</p><p>值得一提的是：由于「SH」函数的旋转性质，[某个旋转过后的基函数可以用同阶基函数线性组合得到](#SH properites)，又由于调整光源方向本质上就是对某个些基函数进行旋转，因此，对于旋转后的「SH」函数计算就可以转化为对同一个「SH」的基函数进行不同加权的求和操作。</p><p>经过「PRT」处理以后，原来需要用方盒记录求面光照的数据，就转换为记录基函数各阶的「系数值」，再计算「shading point」的时候，原来是用「lighting」x 「BRDF」的求面积分，现在则可以直接用基函数和系数的乘积和。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609192551.png" alt="image-20210609192550356"></p><h4 id="另一种推导"><a class="anchor" href="#另一种推导">#</a> 另一种推导：</h4><p>把「lighting」和「light transport」都视为一个「SH」函数进行计算</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210610095431.png" alt="image-20210610095423517"></p><p>方程里的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo></mrow><annotation encoding="application/x-tex">\sum</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-.25001em"></span><span class="mop op-symbol small-op" style="position:relative;top:-.0000050000000000050004em">∑</span></span></span></span> 和「基函数系数」提出来得到如下结果</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210610095546.png" alt="image-20210610095545221"></p><p>这个函数看上去像是一个 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p \times q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> 阶的（这里一般情况下 p 和 q 阶数可以视为相同），和之前的推到有冲突（之前结果是 i 阶），但实际上由于基函数的「正交性」，在基函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">B_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 上投影基函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">B_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 结果要不为 0，那么只能说明 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>p</mi></msub><mo>=</mo><mo>=</mo><msub><mi>B</mi><mi>q</mi></msub></mrow><annotation encoding="application/x-tex">B_p == B_q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span></span><span class="base"><span class="strut" style="height:.36687em;vertical-align:0"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.969438em;vertical-align:-.286108em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.15139200000000003em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:.03588em">q</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.286108em"><span></span></span></span></span></span></span></span></span></span> 。类似 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>×</mo><mi>q</mi></mrow><annotation encoding="application/x-tex">p \times q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.7777700000000001em;vertical-align:-.19444em"></span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.625em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.03588em">q</span></span></span></span> 的矩阵，只有对角线上值不为 0，计算得到的结果还是 p 或 q 阶 或者说 i 阶。</p><h4 id="diffuse-rendering-results"><a class="anchor" href="#diffuse-rendering-results">#</a> Diffuse Rendering Results</h4><p>计算方程内如果带上了「Visibility 函数」那么最终结果就会是有「shadow」的。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609193452.png" alt="image-20210609193451323"></p><h3 id="glossy-brdf-case"><a class="anchor" href="#glossy-brdf-case">#</a> Glossy BRDF Case</h3><p>「Glossy BRDF」相比于「Diffuse BRDF」区别在于，不但要考虑入射角，还得考虑出射角，「Diffuse BRDF」的出射结果和出射方向关系不大，任意方向结果一致。但是「Glossy BRDF」针对不同的出射方向结果可能相差甚远。因此「Diffuse BRDF」的方程针对不同的入射角得到的是一个确定的结果，而「Glossy BRDF」针对不过的入射角，得到的是一个和出射角有关的方程。</p><p>这里再对 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>o</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_i(o)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.13889em">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.13889em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">o</span><span class="mclose">)</span></span></span></span> 进行基函数展开，就可以得到一个和入射角和出射角有关的基函数方程：</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210610102104.png" alt="image-20210610102103460"></p><p>因此，「light transport」的预处理结果会是一个二维的贴图，横轴和纵轴分别表示「出射角」和「入射角」。</p><p>计算公式 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi><mo stretchy="false">(</mo><mi>o</mi><mo stretchy="false">)</mo><mo>=</mo><mi>l</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi><mo>×</mo><mi>t</mi><mi>r</mi><mi>a</mi><mi>n</mi><mi>s</mi><mi>p</mi><mi>o</mi><mi>r</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">L(o) = light \times transport</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord mathnormal">o</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:.8888799999999999em;vertical-align:-.19444em"></span><span class="mord mathnormal" style="margin-right:.01968em">l</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:.03588em">g</span><span class="mord mathnormal">h</span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">×</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:.80952em;vertical-align:-.19444em"></span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">a</span><span class="mord mathnormal">n</span><span class="mord mathnormal">s</span><span class="mord mathnormal">p</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">t</span></span></span></span> 。就是对一个一维向量和一个二维矩阵做乘积，最终结果是一个和「出射角」有关的一维向量。已知「入射角」然后根据不同的「出射角」进行查询，就可以得到对应的结果。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210610102044.png" alt="image-20210610102043210"></p><h4 id="glossy-rendering-results"><a class="anchor" href="#glossy-rendering-results">#</a> Glossy Rendering Results</h4><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210610104539.png" alt="image-20210610104537856"></p><h3 id="time-complexity"><a class="anchor" href="#time-complexity">#</a> Time Complexity</h3><ul><li>「SH」 Basis：9 / 16 / 25。diffuse 情况下一般 3 阶（9）足够，glossy 情况下 4 阶（16）和 5 阶（25）都有。</li><li>Diffuse Rendering（以 16 个基函数为例）<ul><li>任意位置的计算：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo stretchy="false">(</mo><mn>16</mn><mo stretchy="false">)</mo><mo>⋅</mo><mi>v</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo stretchy="false">(</mo><mn>16</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">vector(16) \cdot vector(16)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">6</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">6</span><span class="mclose">)</span></span></span></span></li></ul></li><li>Glossy Rendering（以 16 个基函数为例）<ul><li>任意位置的计算：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mi>e</mi><mi>c</mi><mi>t</mi><mi>o</mi><mi>r</mi><mo stretchy="false">(</mo><mn>16</mn><mo stretchy="false">)</mo><mo>∗</mo><mi>m</mi><mi>a</mi><mi>t</mi><mi>r</mi><mi>i</mi><mi>x</mi><mo stretchy="false">(</mo><mn>16</mn><mo>∗</mo><mn>16</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">vector(16) * matrix(16 * 16)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal" style="margin-right:.03588em">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal">c</span><span class="mord mathnormal">t</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">6</span><span class="mclose">)</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord mathnormal">m</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal" style="margin-right:.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">x</span><span class="mopen">(</span><span class="mord">1</span><span class="mord">6</span><span class="mspace" style="margin-right:.2222222222222222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord">1</span><span class="mord">6</span><span class="mclose">)</span></span></span></span></li></ul></li></ul><h3 id="precomputation"><a class="anchor" href="#precomputation">#</a> Precomputation</h3><p>对于「基函数系数」的另一种理解是：</p><p>用「基函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>i</mi></msub><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">B_i(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-.25em"></span><span class="mord"><span class="mord mathnormal" style="margin-right:.05017em">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:-.05017em;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">i</span><span class="mclose">)</span></span></span></span>」作为「光照函数 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">L_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:.83333em;vertical-align:-.15em"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:.31166399999999994em"><span style="top:-2.5500000000000003em;margin-left:0;margin-right:.05em"><span class="pstrut" style="height:2.7em"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:.15em"><span></span></span></span></span></span></span></span></span></span>」对一个物体的各个「shading point」进行计算，最终得到的贴图。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609192916.png" alt="image-20210609192914974"></p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210609193144.png" alt="image-20210609193142776"></p><h3 id="limitations"><a class="anchor" href="#limitations">#</a> Limitations</h3><ul><li>Low-frequency<ul><li>由于「SH」本身性质，导致其处理的频阶有限，虽然可以无限展开，但实际情况下不能这么处理。</li></ul></li><li>Dynamic lighting, but static scene/material<ul><li>改变场景或者 BRDF 会使得之前的预处理结果失效，需要重新计算。</li></ul></li><li>Big precomputation data</li></ul><h2 id="more-basis-functions"><a class="anchor" href="#more-basis-functions">#</a> More basis functions</h2><ul><li>Spherical Harmonics（SH）</li><li>Wavelet</li><li>Zonal Harmonics</li><li>Spherical Gaussian（SG）</li><li>Piecewise Constant</li></ul><h3 id="wavelet"><a class="anchor" href="#wavelet">#</a> Wavelet</h3><p>2D Haar wavelet</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210610142952.png" alt="image-20210610142951486"></p><ul><li>A non-linear approximation：给定任何二维的函数，都可以投影到 wavelet 基函数上，并得到基函数系数。因此，可以保留其中系数较大的基函数。</li><li>All-frequency representation：由于可以对任意二维函数进行投影，因此可以覆盖所有频率的函数 —— 高频 or 低频。</li></ul><h4 id="wavelet-transform"><a class="anchor" href="#wavelet-transform">#</a> wavelet transform</h4><p>把一个二维函数描述成一个「cube map」，并对这张「cube map」进行 wavelet transform。</p><p>「wavelet transform」会把图中每个块分成四份，其中左上角保留低频数据，其他三个角记录高频数据。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210610153552.png" alt="image-20210610153550885"></p><p>依次类推，直到达到一个满意的精度。这样就既能够保留高频信息，又可以不增加存储量的得到基函数系数。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210610153156.png" alt="image-20210610153154851"></p><p>渲染出的结果可以支持低频和高频，但由于「Wavelet」没有「SH」的旋转特性，因此缺点是不支持对光源的旋转。</p><p><img data-src="https://blog-1255596461.cos.ap-guangzhou.myqcloud.com/blog_pic/20210610154110.png" alt="image-20210610154109532"></p><div class="tags"><a href="/tags/%E5%9B%BE%E5%BD%A2%E5%AD%A6/" rel="tag"><i class="ic i-tag"></i> 图形学</a> <a href="/tags/%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0/" rel="tag"><i class="ic i-tag"></i> 线性代数</a> <a href="/tags/OpenGL/" rel="tag"><i class="ic i-tag"></i> OpenGL</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2022-12-29 09:36:04" itemprop="dateModified" datetime="2022-12-29T09:36:04+08:00">2022-12-29</time> </span><span id="learning/games/Game202/三、Real-time Environment Mapping/" class="item leancloud_visitors" data-flag-title="三、Real-time Environment Mapping" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 充电</button><p>请我[恰饭]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="鑫酱(●'◡'●) 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="鑫酱(●'◡'●) 支付宝"><p>支付宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>鑫酱(●'◡'●) <i class="ic i-at"><em>@</em></i>鑫酱</li><li class="link"><strong>本文链接：</strong> <a href="https://hakuya.me/learning/games/Game202/%E4%B8%89%E3%80%81Real-time%20Environment%20Mapping/" title="三、Real-time Environment Mapping">https://hakuya.me/learning/games/Game202/三、Real-time Environment Mapping/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/learning/games/Game202/%E4%BA%8C%E3%80%81Real-time%20Shadows/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;wallpaper-1255596461.cos.ap-nanjing.myqcloud.com&#x2F;wallpaper (26).jpg" title="二、Real-time Shadows"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> GAME202高质量实时渲染</span><h3>二、Real-time Shadows</h3></a></div><div class="item right"><a href="/learning/games/Game202/%E5%9B%9B%E3%80%81Real-time%20Global%20Illumination/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;wallpaper-1255596461.cos.ap-nanjing.myqcloud.com&#x2F;wallpaper (8).jpg" title="四、Real-time Global Illumination"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> GAME202高质量实时渲染</span><h3>四、Real-time Global Illumination</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#real-time-environment-mapping"><span class="toc-number">1.</span> <span class="toc-text">Real-time Environment Mapping</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#shading-from-environment-lighting"><span class="toc-number">1.1.</span> <span class="toc-text">Shading from Environment Lighting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#how-to-use-it-to-shade-a-pointwithout-shadows"><span class="toc-number">1.1.1.</span> <span class="toc-text">How to use it to shade a point（without shadows）？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#observation"><span class="toc-number">1.1.2.</span> <span class="toc-text">Observation</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#brdf%E7%9A%84%E7%89%B9%E6%80%A7"><span class="toc-number">1.1.2.1.</span> <span class="toc-text">BRDF 的特性：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-split-sum"><span class="toc-number">1.2.</span> <span class="toc-text">The Split Sum</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#step1prefiltering-of-the-environment-lighting"><span class="toc-number">1.2.1.</span> <span class="toc-text">【step1】Prefiltering of the environment lighting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#step2prefiltering-of-the-environment-lighting"><span class="toc-number">1.2.2.</span> <span class="toc-text">【step2】Prefiltering of the environment lighting</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#microfacet-brdf"><span class="toc-number">1.2.2.1.</span> <span class="toc-text">Microfacet BRDF</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#split-again"><span class="toc-number">1.2.2.2.</span> <span class="toc-text">Split again</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#the-split-sum-approximation"><span class="toc-number">1.3.</span> <span class="toc-text">The Split Sum Approximation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#shadow-from-environment-lighting"><span class="toc-number">1.4.</span> <span class="toc-text">Shadow from Environment Lighting</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#industrial-solution"><span class="toc-number">1.4.1.</span> <span class="toc-text">Industrial solution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#related-research"><span class="toc-number">1.4.2.</span> <span class="toc-text">Related research</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fourier-transform"><span class="toc-number">1.5.</span> <span class="toc-text">Fourier Transform</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#general-understanding"><span class="toc-number">1.5.1.</span> <span class="toc-text">general understanding</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#basis-functions"><span class="toc-number">1.6.</span> <span class="toc-text">Basis Functions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#real-time-environment-lighting-global-illumination"><span class="toc-number">1.7.</span> <span class="toc-text">Real-time environment lighting（&amp; global illumination）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#spherical-harmonics"><span class="toc-number">1.7.1.</span> <span class="toc-text">Spherical Harmonics</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#sh-properites"><span class="toc-number">1.7.1.1.</span> <span class="toc-text">SH properites</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#perfiltering"><span class="toc-number">1.7.2.</span> <span class="toc-text">Perfiltering</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#analytic-irradiance-formula"><span class="toc-number">1.7.3.</span> <span class="toc-text">Analytic Irradiance Formula</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#9-parameter-approximation"><span class="toc-number">1.7.3.1.</span> <span class="toc-text">9 Parameter Approximation</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#in-real-time-renderingfyi"><span class="toc-number">1.7.4.</span> <span class="toc-text">In Real-Time Rendering（FYI）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#precomputed-radiance-transferprt"><span class="toc-number">1.8.</span> <span class="toc-text">Precomputed Radiance Transfer（PRT）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rendering-under-environment-lighting"><span class="toc-number">1.8.1.</span> <span class="toc-text">Rendering under environment lighting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#basic-idea-of-prt"><span class="toc-number">1.8.2.</span> <span class="toc-text">Basic idea of PRT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#diffuse-brdf-case"><span class="toc-number">1.8.3.</span> <span class="toc-text">Diffuse BRDF Case</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%A6%E4%B8%80%E7%A7%8D%E6%8E%A8%E5%AF%BC"><span class="toc-number">1.8.3.1.</span> <span class="toc-text">另一种推导：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#diffuse-rendering-results"><span class="toc-number">1.8.3.2.</span> <span class="toc-text">Diffuse Rendering Results</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#glossy-brdf-case"><span class="toc-number">1.8.4.</span> <span class="toc-text">Glossy BRDF Case</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#glossy-rendering-results"><span class="toc-number">1.8.4.1.</span> <span class="toc-text">Glossy Rendering Results</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#time-complexity"><span class="toc-number">1.8.5.</span> <span class="toc-text">Time Complexity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#precomputation"><span class="toc-number">1.8.6.</span> <span class="toc-text">Precomputation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#limitations"><span class="toc-number">1.8.7.</span> <span class="toc-text">Limitations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#more-basis-functions"><span class="toc-number">1.9.</span> <span class="toc-text">More basis functions</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#wavelet"><span class="toc-number">1.9.1.</span> <span class="toc-text">Wavelet</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#wavelet-transform"><span class="toc-number">1.9.1.1.</span> <span class="toc-text">wavelet transform</span></a></li></ol></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/learning/games/Game202/%E4%B8%80%E3%80%81Recap%20of%20CG%20Basics/" rel="bookmark" title="一、Recap of CG Basics">一、Recap of CG Basics</a></li><li><a href="/learning/games/Game202/%E4%BA%8C%E3%80%81Real-time%20Shadows/" rel="bookmark" title="二、Real-time Shadows">二、Real-time Shadows</a></li><li class="active"><a href="/learning/games/Game202/%E4%B8%89%E3%80%81Real-time%20Environment%20Mapping/" rel="bookmark" title="三、Real-time Environment Mapping">三、Real-time Environment Mapping</a></li><li><a href="/learning/games/Game202/%E5%9B%9B%E3%80%81Real-time%20Global%20Illumination/" rel="bookmark" title="四、Real-time Global Illumination">四、Real-time Global Illumination</a></li><li><a href="/learning/games/Game202/%E4%BA%94%E3%80%81Real-time%20Physically-based%20Materials/" rel="bookmark" title="五、Real-time Physically-based Materials">五、Real-time Physically-based Materials</a></li><li><a href="/learning/games/Game202/%E5%85%AD%E3%80%81Real-time%20Ray%20Tracing/" rel="bookmark" title="六、Real-time Ray Tracing">六、Real-time Ray Tracing</a></li><li><a href="/learning/games/Game202/%E4%B8%83%E3%80%81Practical%20Industrial%20Solutions/" rel="bookmark" title="七、Practical Industrial Solutions">七、Practical Industrial Solutions</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="鑫酱(●'◡'●)" data-src="/images/avatar.jpg"><p class="name" itemprop="name">鑫酱(●'◡'●)</p><div class="description" itemprop="description">整天摸鱼，却妄想拯救世界的技术宅</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">110</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">25</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">67</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL0FsbGVuR1g=" title="https:&#x2F;&#x2F;github.com&#x2F;AllenGX"><i class="ic i-github"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTgwNTM4MjQy" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;80538242"><i class="ic i-cloud-music"></i></span> <span class="exturl item email" data-url="bWFpbHRvOjE0MTM5MDcxNTNAcXEuY29t" title="mailto:1413907153@qq.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>好友</a></li><li class="item"><a href="/links/" rel="section"><i class="ic i-magic"></i>网址</a></li><li class="item"><a href="/travellings/" rel="section"><i class="ic i-paper-plane"></i>传送门</a></li><li class="item"><a href="/mikutap/" rel="section"><i class="ic i-star"></i>Mikutap</a></li><li class="item"><a href="/restart/" rel="section"><i class="ic i-sun"></i>RestartLife</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/learning/games/Game202/%E4%BA%8C%E3%80%81Real-time%20Shadows/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/learning/games/Game202/%E5%9B%9B%E3%80%81Real-time%20Global%20Illumination/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/" title="分类于 编程语言">编程语言</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/python/" title="分类于 python">python</a></div><span><a href="/learning/programlanguage/python/Python2-Yield-Async/" title="python2解决异步协程问题">python2解决异步协程问题</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/unreal/" title="分类于 UE">UE</a></div><span><a href="/learning/unreal/UE%20Delegate/" title="UE Delegate">UE Delegate</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/games/" title="分类于 Games系列">Games系列</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/games/Game101/" title="分类于 Games101图形渲染">Games101图形渲染</a></div><span><a href="/learning/games/Game101/%E5%8D%81%E3%80%81Geometry%EF%BC%88%E4%B8%8A%EF%BC%89/" title="十、Geometry（上）">十、Geometry（上）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/compile/" title="分类于 编译相关">编译相关</a></div><span><a href="/learning/compile/cmake/" title="cmake">cmake</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/" title="分类于 编程语言">编程语言</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/cpp/" title="分类于 cpp">cpp</a></div><span><a href="/learning/programlanguage/cpp/%E5%85%AD%E3%80%81%E5%88%86%E6%94%AF%E8%AF%AD%E5%8F%A5%E5%92%8C%E9%80%BB%E8%BE%91%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="六、分支语句和逻辑表达式">六、分支语句和逻辑表达式</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/" title="分类于 编程语言">编程语言</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/cpp/" title="分类于 cpp">cpp</a></div><span><a href="/learning/programlanguage/cpp/%E5%8D%81%E4%B8%83%E3%80%81%E8%BE%93%E5%85%A5%E3%80%81%E8%BE%93%E5%87%BA%E5%92%8C%E6%96%87%E4%BB%B6/" title="十七、输入、输出和文件">十七、输入、输出和文件</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/" title="分类于 编程语言">编程语言</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/cpp/" title="分类于 cpp">cpp</a></div><span><a href="/learning/programlanguage/cpp/%E4%B8%83%E3%80%81%E5%87%BD%E6%95%B0%E6%8C%87%E9%92%88/" title="七、函数指针">七、函数指针</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/games/" title="分类于 Games系列">Games系列</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/games/Game101/" title="分类于 Games101图形渲染">Games101图形渲染</a></div><span><a href="/learning/games/Game101/%E5%8D%81%E5%9B%9B%E3%80%81Ray%20Tracing%20&&%20Rasterization/" title="十四、Ray Tracing &amp;&amp; Rasterization">十四、Ray Tracing && Rasterization</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/games/" title="分类于 Games系列">Games系列</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/games/Game101/" title="分类于 Games101图形渲染">Games101图形渲染</a></div><span><a href="/learning/games/Game101/%E4%BA%8C%E5%8D%81%E4%B8%89%E3%80%81Animation%EF%BC%88%E4%B8%8A%EF%BC%89/" title="二十三、Animation（上）">二十三、Animation（上）</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/learning/" title="分类于 学习">学习</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/" title="分类于 编程语言">编程语言</a> <i class="ic i-angle-right"></i> <a href="/categories/learning/programlanguage/cpp/" title="分类于 cpp">cpp</a></div><span><a href="/learning/programlanguage/cpp/%E4%BA%94%E3%80%81%E5%BE%AA%E7%8E%AF%E5%92%8C%E5%85%B3%E7%B3%BB%E8%A1%A8%E8%BE%BE%E5%BC%8F/" title="五、循环和关系表达式">五、循环和关系表达式</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">鑫酱(●'◡'●) @ 个人博客</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">641k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">9:43</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"learning/games/Game202/三、Real-time Environment Mapping/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,copy_tex:!0,katex:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/animejs@3.2.0/lib/anime.min.js,npm/katex@0.12.0/dist/contrib/copy-tex.min.js,npm/frappe-charts@1.5.0/dist/frappe-charts.min.iife.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/quicklink@2/dist/quicklink.umd.js,gh/amehime/MiniValine@4.2.2-beta10/dist/MiniValine.min.js"></script><script src="/js/app.js?v=0.2.5"></script><script data-pjax>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?b6d809b500bd6f0040117088899bc7bf";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></body></html>